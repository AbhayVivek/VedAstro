@using VedAstro.Library
@attribute [Route(PageRoute.SavedMatchReports)]



<PageTitle>Saved Matches</PageTitle>

<PageTop Title="Saved Matchs" IconName="flat-color-icons:view-details">
    <Description>Match report saved under your account</Description>
</PageTop>

<SavedMatchReportList @ref="savedMatchReportList" />

@code {

    private SavedMatchReportList savedMatchReportList;

    private List<CompatibilityReport> matchReportList = new List<CompatibilityReport>();
    private bool _isReady = false;

    private async Task<List<CompatibilityReport>> GetExampleReports()
    {
        var returnVal = new List<CompatibilityReport>()
        {
            await WebsiteTools.GetCompatibilityReport("70d6a995dec84c0aa74211ac9ff50d29", "8e9b5804e68a4b82a1a975ebee1643dc"),
            await WebsiteTools.GetCompatibilityReport("70d6a995dec84c0aa74211ac9ff50d29", "8e9b5804e68a4b82a1a975ebee1643dc")
        };

        return returnVal;
    }
    

    protected override async Task OnInitializedAsync()
    {

        await GenerateTable();
    }

    //█▀█ █▀█ █ █░█ ▄▀█ ▀█▀ █▀▀   █▀▄▀█ █▀▀ ▀█▀ █░█ █▀█ █▀▄ █▀
    //█▀▀ █▀▄ █ ▀▄▀ █▀█ ░█░ ██▄   █░▀░█ ██▄ ░█░ █▀█ █▄█ █▄▀ ▄█

    private async Task GenerateTable()
    {
        await _jsRuntime.ShowLoading();

        _isReady = false;

        //get all people from API server
        //auto checks if people list already loaded before
        //await AppData.TryGetPersonList();

        matchReportList = await GetExampleReports();
        savedMatchReportList.Show(matchReportList);


        _isReady = true;

        _jsRuntime.HideAlert();
    }


    private void PersonNameClicked(Person person)
    {
        _navigation.NavigateTo($"{PageRoute.PersonEditor}/{person.Id}");
    }


}
